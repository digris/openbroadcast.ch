"use strict";var q=Q,$packery=null,MAX_PLACEHOLDERS=14,PROMOS=[{url:"http://google.com",alt:"Promo 1",filename:"1.jpg"},{alt:"Promo 2",filename:"2.jpg"},{url:"http://google.com",alt:"Promo 3",filename:"3.jpg"},{alt:"Promo 4",filename:"4.jpg"},{url:"http://google.com",alt:"Promo 5",filename:"5.jpg"},{url:"http://google.com",alt:"Promo 6",filename:"6.jpg"},{url:"http://google.com",alt:"Promo 7",filename:"7.jpg"},{url:"http://google.com",alt:"Promo 8",filename:"8.jpg"},{alt:"Promo 9",filename:"9.jpg"},{url:"http://google.com",alt:"Promo 10",filename:"10.jpg"},{url:"http://google.com",alt:"Promo 11",filename:"11.jpg"},{url:"http://google.com",alt:"Promo 12",filename:"12.jpg"},{alt:"Promo 13",filename:"13.jpg"},{url:"http://google.com",alt:"Promo 14",filename:"14.jpg"}],ROOT_URL="https://webview-prod.radioplayer.co.uk",PROMO_URL="//radioplayer.co.uk.s3.amazonaws.com/webviews/promos/",AMAZON_AFFILIATE_TAG="radioplayer.wv.uk-21",IE8=!1,HTTPS=!1,pendingXDR=[],_utils={};_utils.getParameterByName=function(a,b){b||(b=window.location.href),a=a.replace(/[\[\]]/g,"\\$&");var c=new RegExp("[?&]"+a+"(=([^&#]*)|&|#|$)"),d=c.exec(b);return d?d[2]?decodeURIComponent(d[2].replace(/\+/g," ")):"":null},_utils.loadScript=function(a,b){var c=document.getElementsByTagName("head")[0],d=document.createElement("script");d.type="text/javascript",d.src=a,"undefined"===d.onload||"undefined"==typeof d.onload?d.onreadystatechange=b:d.onload=b,c.appendChild(d)},_utils.getWidth=function(){var a=window,b=document,c=b.documentElement,d=b.getElementsByTagName("body")[0],e=a.innerWidth||c.clientWidth||d.clientWidth;return e},_utils.getRandomPlaceholder=function(){var a=Math.floor(Math.random()*MAX_PLACEHOLDERS)+1;return lastUsedPlaceholders.indexOf(a)>-1?_utils.getRandomPlaceholder():(lastUsedPlaceholders.push(a),lastUsedPlaceholders.length>3&&lastUsedPlaceholders.shift(),a)},_utils.getRandomPromo=function(){var a=Math.floor(Math.random()*PROMOS.length);return data.usedPromos.indexOf(a)>-1?_utils.getRandomPromo():(data.usedPromos.push(a),a)},_utils.cleanAffiliate=function(a){if(a.indexOf("%26tag%3D")>-1&&a.indexOf("%26linkCode")>-1){var b=a.indexOf("%26tag%3D")+9,c=a.substr(0,b),d=a.indexOf("%26linkCode"),e=a.substr(d,a.length);a=c+AMAZON_AFFILIATE_TAG+e}return a},_utils.exists={},_utils.exists.router=function(a){var b=!1;return b=!a._source||"facebook"!==a._source&&"twitter"!==a._source?!a.start||!a.name||_utils.exists.rp(a):_utils.exists.social(a)},_utils.exists.social=function(a){for(var b=!1,c=data.past.length,d=0;d<c;d++)if(data.past[d]._source&&("facebook"===data.past[d]._source||"twitter"===data.past[d]._source)&&data.past[d].id&&a.id&&data.past[d].id===a.id){b=!0;break}return b},_utils.exists.rp=function(a){for(var b=!1,c=data.past.length,d=0;d<c;d++)if(data.past[d].name&&data.past[d].start&&data.past[d].name===a.name){var e=new Date(data.past[d].start).getTime(),f=new Date(a.start).getTime();if(e===f){b=!0;break}}return b},_utils.checkCalcSupport=function(){if($("body").append('<div id="css3-calc"></div>'),10==$("#css3-calc").width()){var a=_utils.getWidth();if(a<700){var b=Math.floor(a)/2-5;$(".grid-track").css("width",b+"px"),$(".grid-sizer").css("width",b+"px"),$(".grid-tweet-with-image").css("width","100%"),$(".grid-tweet").css("width","100%"),$(".grid-item-fb").css("width","100%")}else{var b=Math.floor(a)/4-7.5;$(".grid-track").css("width",b+"px"),$(".grid-sizer").css("width",b+"px");var c=b;if(!_chromecast)var c=Math.floor(a)/2-5;$(".grid-tweet-with-image").css("width",c+"px"),$(".grid-tweet").css("width",c+"px"),$(".grid-item-fb").css("width",c+"px")}percentPosition=!1}$("#css3-calc").remove()},_utils.ajax=function(a,b){var c;c=window.XDomainRequest?new XDomainRequest:window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),c.onload=function(){pendingXDR=[],b(c.responseText)},c.open("GET",a,!0),c.onerror=function(){},c.onprogress=function(){},c.ontimeout=function(){},c.send(),pendingXDR.push(c)};var _ui={};_ui.applyResponsiveFixes=function(){$(".radioplayer").width()>720?$("body").addClass("_larger_console"):$("body").removeClass("_larger_console")},_ui.showNewItemsMessage=function(){if(data.numberOfNewItems&&!_isOnDemand){if(data.numberOfNewItems<50){var a=data.numberOfNewItems+" new item";data.numberOfNewItems>1&&(a+="s")}else var a="New Items";$(".new-items-inner").html(a),$(".new-items").hasClass("new-items--open")||$(".new-items").addClass("new-items--open")}else _isOnDemand||$(".new-items").removeClass("new-items--open")};var rpid=null,bbc=!1,gotFeed=!1,data={past:[],future:[],newItems:[],current:null,rawCurrent:null,od:{},iteration:0,lat:51.5020825,lon:-.1400619,numberOfNewItems:0,usedPromos:[]},lastUsedPlaceholders=[],percentPosition=!0,screenWidth=_utils.getWidth(),refreshingInProgress=!1,_appInBackground=!1,_npTimeout=null,_isOnDemand=!1,_chromecast=!1,refreshPage=function(a){if(!_isOnDemand||!gotFeed)if(data.iteration++,data.iteration%2===1)getFeed(a);else{var b=data.future.concat(data.past);sortFeed(b),_chromecast||_ui.showNewItemsMessage(),setTimeout(function(){refreshPage(a)},6e4)}},getFeed=function(a){if(refreshingInProgress)return!1;if(a){refreshingInProgress=!0;var b=ROOT_URL+"/getOrganisedFeed/"+a;_utils.ajax(b,feedSuccess)}},feedSuccess=function(a){a=JSON.parse(a),data.name=a.name,data.description=a.description,a.feed&&a.feed.length?handleNewFeedData(a.feed):handleEmptyFeedResponse(a)},feedError=function(){refreshingInProgress=!0,handleEmptyFeedResponse({})},handleNewFeedData=function(a){sortFeed(a),_chromecast&&data.past.length<10?badDataChromecast():gotFeed?_chromecast&&data.numberOfNewItems?updateItems():data.numberOfNewItems&&_ui.showNewItemsMessage():(gotFeed=!0,displayItems()),refreshingInProgress=!1,setTimeout(function(){refreshPage(rpid)},6e4)},sortFeed=function(a){for(var b=[],c=[],d=[],e=(new Date).getTime(),f=a.length,g=0;g<f;g++)if(a[g].start){var h=+new Date(a[g].start).getTime();if(h>e)b.push(a[g]);else{var i=a[g].stop?new Date(a[g].stop).getTime():null;i&&e>=h&&e<=i||!a[g].name&&"twitter"!==a[g]._source||(c.push(a[g]),_utils.exists.router(a[g])||(data.numberOfNewItems++,_chromecast&&d.push(a[g])))}}data.past=c,data.future=b,data.newItems=d,_chromecast||(data.future&&data.future.length?($(".now-playing").addClass("now-playing-with-coming-soon"),$(".new-items-inner").addClass("new-items-inner-with-coming-soon")):($(".new-items-inner").removeClass("new-items-inner-with-coming-soon"),$(".now-playing").removeClass("now-playing-with-coming-soon")))},handleEmptyFeedResponse=function(a){data.name?$(".now-playing-name").html(data.name):$(".now-playing-name").html("Live radio"),_chromecast||($(".now-playing-description").html(data.description),$(".now-playing").show()),$("#loading").hide(),$(".feed-loading").hide(),$(".coming-up").hide(),$(".feed").show(),addPromos()},addPromos=function(){if(!data.usedPromos.length){for(var a=0;a<8;a++){var b=0;b=_utils.getRandomPromo();var c="<div class='grid-item'>";c+=PROMOS[b].url?"<a class='grid-item-inner' target='_blank' href='"+PROMOS[b].url+"' style='background-image: url("+PROMO_URL+PROMOS[b].filename+")' aria-label='"+PROMOS[b].alt+"'></a>":"<div class='grid-item-inner' style='background-image: url("+PROMO_URL+PROMOS[b].filename+")' aria-label='"+PROMOS[b].alt+"'></div>",c+="</div>",$("#feed").append(c)}_utils.checkCalcSupport(),_ui.applyResponsiveFixes(),$("#feed").show(),$packery||($packery=$("#feed").packery({itemSelector:".grid-item",percentPosition:percentPosition,gutter:10,columnWidth:".grid-sizer"}))}},updateItems=function(){updatePast()},updatePast=function(){if(data.newItems&&data.newItems.length){for(var a=data.newItems.length,b=0;b<a;b++)addItemRouter(data.newItems[b],!0);data.numberOfNewItems=0,data.newItems=[],jQuery("time.timeago").timeago()}},displayItems=function(){$("body").removeClass("_chromecastBadData"),displayPast(),_chromecast||(displayFuture(),_isOnDemand&&!data.od.name&&displayCurrent())},badDataChromecast=function(){$("#feed").hide(),$("#loading").hide(),$(".feed-loading").hide(),$("body").addClass("_chromecastBadData")},albumArtProtocol=function(a){return HTTPS&&a.indexOf("https")<0&&a.indexOf("http")>=0&&(a=a.replace("http","https")),a},displayPast=function(){$("#feed").hide(),$("#feed").html('<div class="grid-sizer"></div>'),$(".feed-loading").show(),$packery&&($packery.packery("destroy"),$packery=null);var a=data.past,b=a.length;if(_chromecast&&!bbc&&(b=b>25?25:b),b){for(var c=0;c<b;c++)addItemRouter(a[c]);_utils.checkCalcSupport(),_ui.applyResponsiveFixes()}$(".feed").show(),$("#loading").hide(),$(".feed-loading").hide(),$("#feed").show(),b&&(_chromecast||$(".recent-activity").show(),$packery?$packery.layoutItems($(".grid-item")):($packery=$("#feed").packery({itemSelector:".grid-item",percentPosition:percentPosition,gutter:10,columnWidth:".grid-sizer"}),jQuery("time.timeago").timeago())),_isOnDemand||_chromecast?_chromecast||$(".recent-activity-title").html("Recently on "+data.name):$(".recent-activity-title").html("Recently"),data.numberOfNewItems=0},addItemRouter=function(a,b){if(a._source&&"twitter"===a._source)addItem.tweet(a,b);else if(a._source&&"facebook"===a._source)addItem.facebook(a,b);else if(a._source&&"schedule"===a._source)addItem.schedule(a,b);else if(a.type&&"song"===a.type&&a.album&&a.album.large){var c=a.album.large;screenWidth<=320&&(c=a.album.medium),a.album.large=albumArtProtocol(a.album.large),addItem.track(a,a.album.large,b)}else if(a.type&&"song"===a.type){var d=0,d=_utils.getRandomPlaceholder(),e="feed/img/albums/"+d+".jpg";addItem.track(a,e,b)}else addItem.programme(a,b)},addItem={track:function(a,b,c){if(bbc)return!1;var d="<div class='grid-item grid-track'>";d+="<div class='grid-item-inner' style='background-image: url("+b+")''>";var e=a.stop||a.start;d+="<div class='overlay'>",d+="<time class='date-time timeago' datetime='"+e+"'>"+e+"</time>";var f=a.name,g=a.artist;if(d+="<div class='track-name'>"+f+"</div>",d+="<div class='track-artist'>"+g+"</div>",a.album=a.album||{},a.album.affiliate){var h=_utils.cleanAffiliate(a.album.affiliate);d+="<a href='"+h+"' target='_blank' class='track-buy'>Buy</a>"}if(d+="</div>",d+="</div>",d+="</div>",c){var i=$(d);$("#feed").prepend(i).packery("prepended",i)}else $("#feed").append(d)},programme:function(a,b){},schedule:function(a,b){if(a.start){var c=new Date(a.start).getHours(),d=new Date(a.start).getMinutes();d<=9&&(d="0"+d);var e=c+":"+d}if(a.stop){var c=new Date(a.stop).getHours(),d=new Date(a.stop).getMinutes();d<=9&&(d="0"+d);var f=c+":"+d}var g="<div class='grid-item grid-schedule'>";if(g+="<i class='fa fa-microphone' aria-hidden='true'></i>",g+=a.name,a.start&&(g+="<div class='time-scheduled'>"+e),g+=a.stop?" - "+f+"</div>":"</div>",g+="</div>",b){var h=$(g);$("#feed").prepend(h).packery("prepended",h)}else $("#feed").append(g)},tweet:function(a,b){var c=null;if($("html").hasClass("ie8")){var d=a.start.split(" ");c=new Date(Date.parse(d[1]+" "+d[2]+", "+d[5]+" "+d[3]+" GMT")),c=jQuery.timeago(c)}else c=a.start;var e="";if(e+=a.images&&a.images.length?'<div class="grid-item grid-tweet-with-image" style="background-image: url('+a.images[0]+')">        <div class="grid-item-tweet-with-image-inner" >          <i class="fa fa-twitter fa-source-type" aria-hidden="true"></i>          <div class="date-checker"><time class="date-time timeago" datetime="'+c+'">'+c+'</time></div>            <div class="twitter-image-text"><span class="grid-title-md">'+a.text+"</span></div>        </div>      </div>":'<div class="grid-item grid-tweet">        <div class="grid-tweet-inner">        <div class="date-checker"><time class="date-time timeago" datetime="'+c+'">'+c+'</time></div>        <div class="grid-tweet-status">          <i class="fa fa-twitter" aria-hidden="true"></i>          '+a.text+"        </div>      </div></div>",b){var f=$(e);$("#feed").prepend(f).packery("prepended",f)}else $("#feed").append(e)},facebook:function(a,b){var c="";if("shared_story"===a.type||"published_story"===a.type){c+="<a target='_blank' href='"+a.link+"' class='grid-item grid-item-fb'  style='background-image: url("+a.image+")'>",c+="<div class='fb-overlay'>",c+="<div class='date-checker'><time class='date-time timeago' datetime='"+a.start+"'>'"+a.start+"'</time></div>",c+="<i class='fa fa-facebook fa-source-type' aria-hidden='true'></i>";var d=a.name||a.description||a.message;d&&(c+="<div class='facebook-image-text'><span><span class='grid-title-lg'>"+d+"</span></span></div>"),a.caption&&(c+="<div class='fb-caption'><i class='fa fa-file-text-o' aria-hidden='true'></i>"+a.caption+"</div>"),c+="</div>",c+="</a>"}else if("photo"===a.type){c+="<a target='_blank' href='"+a.link+"' class='grid-item grid-item-fb grid-item-fb-pic'  style='background-image: url("+a.image+")'>",c+="<div class='fb-overlay'>",c+="<div class='date-checker'><time class='date-time timeago' datetime='"+a.start+"'>'"+a.start+"'</time></div>",c+="<i class='fa fa-facebook fa-source-type' aria-hidden='true'></i>";var e=a.message||a.name;e&&(c+="<div class='facebook-image-text facebook-photo-text'><span><span class='grid-title-lg'>"+e+"</span></span></div>"),c+="<div class='fb-caption'><i class='fa fa-picture-o' aria-hidden='true'></i></div>",c+="</div>",c+="</a>"}else if("added_video"===a.type){c+="<a target='_blank' href='"+a.link+"' class='grid-item grid-item-fb grid-item-fb-pic'  style='background-image: url("+a.image+")'>",c+="<div class='fb-overlay'>",c+="<div class='date-checker'><time class='date-time timeago' datetime='"+a.start+"'>'"+a.start+"'</time></div>",c+="<i class='fa fa-facebook fa-source-type' aria-hidden='true'></i>";var e=a.message||a.name;e&&(c+="<div class='facebook-image-text facebook-video-text'><span><span class='grid-title-lg'>"+e+"</span></span></div>"),c+="<div class='fb-caption'><i class='fa fa-file-video-o' aria-hidden='true'></i>Watch Video</div>",c+="</div>",c+="</a>"}if(b){var f=$(c);$("#feed").prepend(f).packery("prepended",f)}else $("#feed").append(c)}},displayCurrent=function(){_isOnDemand?displayCurrentOD():displayCurrentLive()},displayCurrentLive=function(){if($(".now-playing").removeClass("now-playing-od"),$(".now-playing-od-label").hide(),data.current)if(data.current.song){$(".now-playing-description").hide(),$(".now-playing-timing").hide();var a="";data.current.name&&(a+="<span class='now-playing-artist'>"+data.current.name+"</span>"),data.current.artistName&&data.current.name&&(a+=" by "),data.current.artistName&&(a+="<span class='now-playing-track'>"+data.current.artistName+"</span>"),$(".now-playing-name").html(a),$(".now-playing-title").html(data.name),$(".now-playing").find("i").addClass("fa-music"),$(".now-playing").find("i").removeClass("fa-microphone")}else if("PI"===data.current.type){if($(".now-playing-title").html(data.name),$(".now-playing-name").html(data.current.name),data.current.description?($(".now-playing-description").html(data.current.description),$(".now-playing-description").show()):$(".now-playing-description").hide(),data.current.start&&data.current.stop){var b="",c=new Date(data.current.start).getHours();c<10&&(c="0"+c);var d=new Date(data.current.start).getMinutes();d<10&&(d="0"+d),b+=c+":"+d;var e=new Date(data.current.stop).getHours();e<10&&(e="0"+e);var f=new Date(data.current.stop).getMinutes();f<10&&(f="0"+f),b+=" - "+e+":"+f,$(".now-playing-timing").html(b),$(".now-playing-timing").show()}else $(".now-playing-timing").hide();$(".now-playing").show(),$(".now-playing").find("i").removeClass("fa-music"),$(".now-playing").find("i").addClass("fa-microphone")}else $(".now-playing-timing").hide(),$(".now-playing-title").html("On Air Now"),$(".now-playing-name").html(data.current.serviceName),$(".now-playing-description").html(data.current.description),$(".now-playing").show();else $(".now-playing-timing").hide(),$(".now-playing-title").html("On Air Now"),$(".now-playing-name").html(data.name),$(".now-playing-description").html(data.description),$(".now-playing").show();data.future&&data.future.length?($(".now-playing").addClass("now-playing-with-coming-soon"),$(".new-items-inner").addClass("new-items-inner-with-coming-soon")):($(".new-items-inner").removeClass("new-items-inner-with-coming-soon"),$(".now-playing").removeClass("now-playing-with-coming-soon"))},displayCurrentOD=function(){$(".now-playing-od-label").show(),$(".now-playing").addClass("now-playing-od"),$(".now-playing-timing").hide(),$(".now-playing-title").html("Now Playing"),data.od.name?$(".now-playing-name").html(data.od.name):$(".now-playing-name").html(data.name),$(".now-playing-description").hide(),data.od.description?($(".now-playing").addClass("now-playing-with-coming-soon"),$(".new-items-inner").addClass("new-items-inner-with-coming-soon")):($(".new-items-inner").removeClass("new-items-inner-with-coming-soon"),$(".now-playing").removeClass("now-playing-with-coming-soon")),$(".now-playing").show()},displayFuture=function(){_isOnDemand?displayFutureOD():displayFutureLive()},displayFutureLive=function(){if(data.future&&data.future.length){for(var a=data.future.length,b="<ul>",c=0,d=a-1;d>=0&&!(c>=1);d--){c++;var e=data.future[d];if(b+="<li>",b+=e.name,e.start){var f=new Date(e.start).getHours(),g=new Date(e.start).getMinutes();g<=9&&(g="0"+g),f<=9&&(f="0"+f);var h=f+":"+g;b+="<div class='time-scheduled'>"+h}if(e.stop){var f=new Date(e.stop).getHours(),g=new Date(e.stop).getMinutes();g<=9&&(g="0"+g),f<=9&&(f="0"+f);var h=f+":"+g;b+=" - "+h+"</div>"}else b+="</div>";b+="</li>"}b+="</ul>",$(".coming-up-title").html("Next"),$(".coming-up-background").html(b),$(".coming-up").show()}else $(".coming-up").hide()},displayFutureOD=function(){data.od.description?($(".coming-up-title").html("Description"),$(".coming-up-background").html("<p>"+data.od.description+"</p>"),data.od.start&&$(".coming-up-background").append('<div class="first-available">First available on <strong>'+data.od.start+"</strong></div>"),$(".coming-up").show()):$(".coming-up").hide()},mobileAndTabletcheck=function(){var a=!1;return function(b){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(b)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(b.substr(0,4)))&&(a=!0)}(navigator.userAgent||navigator.vendor||window.opera),a},dragging=!1,ua=navigator.userAgent.toLowerCase(),isAndroid=ua.indexOf("android")>-1;if(isAndroid)var clickHandler="touchend";else var clickHandler="click touchend";$(document).on(clickHandler,".new-items",function(a){a.preventDefault(),a.stopPropagation(),a.stopImmediatePropagation(),data.numberOfNewItems>=50||data.iteration>=60?window.location.reload():($(".new-items").removeClass("new-items--open"),data.iteration=data.iteration%2,displayItems())});var blocked=!1;mobileAndTabletcheck()?$(document).on(clickHandler,".grid-track",function(a){if(!$(a.target).hasClass("track-buy"))return a.preventDefault(),a.stopPropagation(),a.stopImmediatePropagation(),!dragging&&!blocked&&(blocked=!0,$(a.target).hasClass("track-buy")||($(this).hasClass("grid-track-open")?$(".grid-track").removeClass("grid-track-open"):($(".grid-track").removeClass("grid-track-open"),$(this).addClass("grid-track-open"))),setTimeout(function(){blocked=!1},310),!1)}):($(document).on("mouseenter",".grid-track",function(a){return a.preventDefault(),a.stopPropagation(),a.stopImmediatePropagation(),!dragging&&!blocked&&($(this).addClass("grid-track-open"),!1)}),$(document).on("mouseleave",".grid-track",function(a){return a.preventDefault(),a.stopPropagation(),a.stopImmediatePropagation(),!dragging&&!blocked&&($(this).removeClass("grid-track-open"),!1)})),$(document).on(clickHandler,".debug",function(a){$(".debug-inner").show()}),$(document).on("touchmove",function(){dragging=!0}),$(document).on("touchcancel",function(){dragging=!1}),$(document).on("touchstart",function(){dragging=!1}),$(document).on("touchend",function(){dragging=!1}),"undefined"==typeof window.addEventListener&&(window.addEventListener=function(a,b){return window.attachEvent("on"+a,b)}),window.addEventListener("resize",function(){screenWidth=_utils.getWidth(),!percentPosition&&$packery&&_utils.checkCalcSupport(),_ui.applyResponsiveFixes()},!1);var is_initStreams=!1,initStreams=function(){is_initStreams=!0,rpid?(getFeed(rpid),_isOnDemand&&!_chromecast?(displayCurrent(),displayFuture()):_chromecast&&($(".now-playing").hide(),$(".coming-up").hide(),$("#feed").css({"margin-top":"0px"}))):($("#loading").hide(),handleEmptyFeedResponse({}))},initFeed=function(){$(".radioplayer-plugin").empty(),$(".radioplayer-plugin").append('    <div id="feed">      <div class="grid-sizer"></div>    </div>  '),_chromecast||$(".radioplayer-body").before('<div class="recently">Recently</div>'),rpid=_utils.getParameterByName("rpid")||currentStationID;var a=webview.hideAlbums+"";"true"!==a&&"1"!==a&&"yes"!==a||(bbc=!0),_chromecast=!0,$("body").addClass("_chromecast"),initStreams()};$(document).ready(function(){$("html").hasClass("lte9")&&window.location.href.indexOf("https")<0&&(ROOT_URL=ROOT_URL.replace("https","http://labs.radioplayer.co.uk/tinyproxy/?feed=https")),window.location.href.indexOf("https")>=0&&(HTTPS=!0);var a=_utils.getParameterByName("lang")||"en";_utils.loadScript("feed/timeago/jquery.timeago."+a+".js",function(){jQuery("time.timeago").timeago(),initFeed()})});